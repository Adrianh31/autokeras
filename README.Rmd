---
title: "R interface to Auto-Keras"
output: github_document
---

[Auto-Keras](https://autokeras.com/) is an open source software library for 
automated machine learning (AutoML). It is developed by
[DATA Lab](http://faculty.cs.tamu.edu/xiahu/index.html) at Texas A&M
University and community contributors. The ultimate goal of AutoML is to
provide easily accessible deep learning tools to domain experts with limited
data science or machine learning background. Auto-Keras provides functions
to automatically search for architecture and hyperparameters of deep
learning models.

## Dependencies

* [Auto-Keras](https://autokeras.com/) requires Python 3.6 .

## Installation

AutoKeras is currently only available as a GitHub package.
To install it run the following from an R console:

```{r eval=FALSE}
if (!require("devtools"))
  install.packages("devtools")
devtools::install_github("jcrodriguez1989/autokeras")
```

Then, use the `install_autokeras()` function to install TensorFlow:

```{r eval=FALSE}
library("autokeras")
install_autokeras()
```

## Docker

Auto-Keras R package has a configured Docker image.
Steps to run it:

From a bash console:

```{bash eval=FALSE}
docker pull jcrodriguez1989/r-autokeras:0.1.0
docker run -it jcrodriguez1989/r-autokeras:0.1.0 /bin/bash
```

Once inside the Docker image, you can run the example R script:

```{bash eval=FALSE}
Rscript cifar10_example.R
```

## Examples

### CIFAR-10 dataset

```{r eval=FALSE}
library("autokeras")
library("keras")

# Get CIFAR-10 dataset, but not preprocessing needed
cifar10 <- dataset_cifar10()

c(x_train, y_train) %<-% cifar10$train
c(x_test, y_test) %<-% cifar10$test
```

```{r eval=FALSE, include=FALSE}
x_train <- x_train[1:1000,,,]
y_train <- y_train[1:1000]
x_test <- x_test[1:1000,,,]
y_test <- y_test[1:1000]
```

```{r eval=FALSE}
# Create an image classifier, and train different models for 2 hours
clf <- model_image_classifier(verbose=TRUE, augment=FALSE) %>% 
  fit(x_train, y_train, time_limit=2*60*60)
```

```{r eval=FALSE}
# Get the best trained model
# For some bug, this needs to be killed (Ctrl+c), but fits the model anyways
clf %>% final_fit(x_train, y_train, x_test, y_test, retrain=TRUE, time_limit=30)
```

```{r eval=FALSE}
# And use it to evaluate, predict
clf %>% evaluate(x_test, y_test)
clf %>% predict(x_test[1:10,,,])

# get the Keras model to work with the Keras R library
get_keras_model(clf)
```
